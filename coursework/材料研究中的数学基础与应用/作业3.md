# 作业三

学号：BY2401147

姓名：王昌锐

## 第 1 题

某钢材延伸率 $y$ 与碳含量 $x_{1}$ 、回火温度 $x_{2}$ 的关系如表 1 所示，试对其进行二元线性拟合。

表 1

| 序号           | 1  | 2  | 3  | 4  | 5  | 6  | 7  | 8  | 9  | 10 | 11 | 12 | 13 | 14 |
|----------------|----|----|----|----|----|----|----|----|----|----|----|----|----|----|
| $x_{1}$ (wt.%) | 57 | 64 | 69 | 58 | 58 | 58 | 58 | 57 | 64 | 69 | 59 | 64 | 69 | 68 |
| $x_{2}$ ($$ ^\circ C $$)   | 535 | 535 | 535 | 460 | 470 | 480 | 490 | 460 | 435 | 460 | 490 | 467 | 490 | 480 |
| $y$ (%)        | 19.3 | 17.5 | 18.3 | 16.3 | 17.0 | 16.8 | 17.0 | 16.8 | 14.8 | 12.0 | 17.8 | 15.5 | 15.5 | 15.8 |

> 源代码：
> ```Julia
> x1 = [57, 64, 69, 58, 58, 58, 58, 57, 64, 69, 59, 64, 69, 68]
> x2 = [535, 535, 535, 460, 470, 480, 490, 460, 435, 460, 490, 467, 490, 480]
> X = [ones(length(x1)) x1 x2]
> y = [19.3, 17.5, 18.3, 16.3, 17.0, 16.8, 17.0, 16.8, 14.8, 12.0, 17.8, 15.5, 15.5, 15.8]
> b = X \ y
> println(b)
> ```

> 运行结果：
> ```plaintext
> julia> 正在运行 3.1.jl
> [8.771893177381322, -0.20205225480881295, 0.04181273931191196]
> ```

二元线性拟合结果为 $y = 8.77 – 0.20 x_{1} + 0.04 x_{2}$ 。


## 第 2 题

反应动力学中 Hougen-Watson 的模型是非线性模型，其模型如下：

$$
y = \frac{b_{1} x_{2} - b_{2} x_{3} }{ 1 + b_{3} x_{1} + b_{4} x_{2} + b_{5} x_{3}}
$$

其中，$y$ 为反应速率，$y$ 有三个决定因素为 $x_1$ 氢气、 $x_2$ （n-戊烷）、 $x_3$ （异戊烷）。
表 2 是实验数据，试进行多元非线性拟合：

a) 求出未知参数 $b_1$ 、 $b_2$ 、 $b_3$ 、 $b_4$ 、 $b_5$ ；

b) 预测当氢气为 $300 mol/L$ ，n-戊烷为 $100 mol/L$ ，异戊烷为 $50 mol/L$ 时的反应速率。


表 2

| 反应速率（mol/(L·s)） | 8.55 | 3.79 | 4.82 | 0.02 | 2.75 | 14.39 | 2.54 | 4.35 | 13  | 8.5 | 0.05 | 11.32 | 3.13 |
|-----------------------|------|------|------|------|------|-------|------|------|-----|-----|------|-------|------|
| 氢气（mol/L）         | 470  | 285  |	470  | 470  | 470  | 100   | 100  | 470  | 100 | 100 | 100  | 285   | 285  |
| n-戊烷（mol/L）       | 300  | 80   | 300  | 80   | 80   | 190   | 80   | 190  | 300 | 300 | 80   | 300   | 190  |
| 异戊烷（mol/L）       | 10   | 10	  | 120  | 120  | 10   | 10    | 65   | 65   | 54  | 120 | 120  | 10    | 120  |

> 源代码：
```Julia
using TyOptimization
using TyPlot

function MultiXN(B, x)
    x = reshape(x, (:, 3))
    x1 = x[:, 1]
    x2 = x[:, 2]
    x3 = x[:, 3]
    (B[1] .* x1 .- B[2] .* x3) ./ (1 .+ B[3] .* x1 .+ B[4] .* x2 .+ B[5] .* x3)
end
x1 = [470, 285, 470, 470, 470, 100, 100, 470, 100, 100, 100, 285, 285]
x2 = [300, 80, 300, 80, 80, 190, 80, 190, 300, 300, 80, 300, 190]
x3 = [10, 10, 120, 120, 10, 10, 65, 65, 54, 120, 120, 10, 120]
x = [x1; x2; x3]
y = [8.55, 3.79, 4.82, 0.02, 2.75, 14.39, 2.54, 4.35, 13, 8.5, 0.05, 11.32, 3.13]
B0 = rand(5)
B, = lsqcurvefit(MultiXN, B0, x, y)
println(B)

yt = (B[1] * 300 - B[2] * 50) / (1 + B[3] * 300 + B[4] * 100 + B[5] * 50)
println(yt)
```

> 运行结果：
> ```plaintext
> julia> 正在运行 3.2.jl
> [0.03761126326579918, -0.08829406268842606, 0.009723870542794135, -0.010403470217869679, 0.033065393323012324]
> 3.46529618043807
> ```

未知参数 $b_1$ 、 $b_2$ 、 $b_3$ 、 $b_4$ 、 $b_5$ 分别是 0.038、-0.088、0.010、-0.010、0.033；

当氢气为 $300 mol/L$ ，n-戊烷为 $100 mol/L$ ，异戊烷为 $50 mol/L$ 时的反应速率为 3.465 mol/(L·s) 。

